<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WhatsApp Chat Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");
      body {
        font-family: "Inter", sans-serif;
        background-color: #e5ddd5; /* WhatsApp-like background color */
        background-image: url("https://i.imgur.com/ryN2p32.png"); /* Subtle background pattern */
      }
      /* Style for the chat bubbles */
      .chat-bubble {
        max-width: 75%;
        word-wrap: break-word;
      }
      /* Outgoing message bubble */
      .message-out {
        background-color: #dcf8c6;
        align-self: flex-end;
      }
      /* Incoming message bubble */
      .message-in {
        background-color: #ffffff;
        align-self: flex-start;
      }
      /* System message style */
      .system-message {
        background-color: #e1f2fb;
        color: #5b5b5b;
        font-size: 0.8rem;
        text-align: center;
        align-self: center;
      }
      /* Date separator style */
      .date-separator {
        background-color: #e1e8ed;
        color: #5b5b5b;
        font-size: 0.75rem;
        text-align: center;
        align-self: center;
        text-transform: uppercase;
      }
      /* Hide scrollbar but allow scrolling */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    </style>
  </head>
  <body class="flex flex-col h-screen bg-gray-100">
    <!-- Header -->
    <header
      class="bg-[#005e54] text-white p-3 flex items-center shadow-md z-10"
    >
      <div class="flex items-center">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="text-white"
        >
          <path d="M15 18l-6-6 6-6" />
        </svg>
        <img
          src="https://placehold.co/40x40/7e5e5f/white?text=D"
          alt="Profile"
          class="rounded-full w-10 h-10 ml-4"
        />
        <div class="ml-4">
          <h1 class="text-lg font-semibold">+91 70525 52247</h1>
          <p class="text-xs text-gray-300">tap here for contact info</p>
        </div>
      </div>
      <div class="ml-auto flex items-center space-x-4">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="text-white"
        >
          <path
            d="M21.2 15.4c-2.3-1.2-4-2-5.1-2.4-.9-.3-1.6-.2-2.3.4l-1.1 1c-2.7-1.4-4.8-3.5-6.2-6.2l1-1.1c.6-.7.7-1.4.4-2.3-.4-1.1-1.2-2.8-2.4-5.1-.5-1-1.6-1.2-2.6-.7l-2.1 1.1c-1.1.6-1.8 1.8-1.8 3 0 9.9 8.1 18 18 18 1.2 0 2.4-.7 3-1.8l1.1-2.1c.5-1 .3-2.1-.7-2.6z"
          ></path>
        </svg>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="text-white"
        >
          <path
            d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"
          ></path>
          <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
        </svg>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="text-white"
        >
          <circle cx="12" cy="12" r="1"></circle>
          <circle cx="12" cy="5" r="1"></circle>
          <circle cx="12" cy="19" r="1"></circle>
        </svg>
      </div>
    </header>

    <!-- Chat Area -->
    <main
      id="chat-container"
      class="flex-1 p-4 overflow-y-auto no-scrollbar flex flex-col space-y-2"
    >
      <!-- Messages will be injected here by JavaScript -->
    </main>

    <!-- Input Area for Chat Text -->
    <footer class="p-4 bg-white border-t">
      <label
        for="chat-input"
        class="block text-sm font-medium text-gray-700 mb-2"
        >Paste your WhatsApp chat export here:</label
      >
      <textarea
        id="chat-input"
        rows="8"
        class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
      ></textarea>
      <button
        id="render-button"
        class="mt-2 w-full bg-[#25d366] text-white font-semibold py-2 px-4 rounded-md hover:bg-[#128c7e] transition duration-300"
      >
        Render Chat
      </button>
    </footer>

    <script>
      // Function to parse and render the chat
      function renderChat() {
        const chatInput = document.getElementById("chat-input").value.trim();
        const chatContainer = document.getElementById("chat-container");

        // Clear previous chat content
        chatContainer.innerHTML = "";

        if (!chatInput) {
          return;
        }

        const lines = chatInput.split("\n");
        let lastDate = "";

        lines.forEach((line) => {
          line = line.trim();
          if (!line) return;

          // Regex to match a message line: "DD/MM/YYYY, HH:MM - Sender: Message"
          const messageRegex =
            /^(\d{2}\/\d{2}\/\d{4}), (\d{2}:\d{2}) - (.*?): (.*)$/;
          // Regex to match a system message line
          const systemRegex = /^(\d{2}\/\d{2}\/\d{4}), (\d{2}:\d{2}) - (.*)$/;

          const messageMatch = line.match(messageRegex);
          const systemMatch = line.match(systemRegex);

          // --- Handle Date Separators ---
          const currentDate = line.substring(0, 10);
          if (
            /\d{2}\/\d{2}\/\d{4}/.test(currentDate) &&
            currentDate !== lastDate
          ) {
            const dateElement = document.createElement("div");
            dateElement.className =
              "date-separator p-1 px-3 rounded-md shadow-sm my-2";

            // Simple date formatting for display
            const dateParts = currentDate.split("/");
            const dateObj = new Date(
              `${dateParts[2]}-${dateParts[1]}-${dateParts[0]}`
            );
            const options = { year: "numeric", month: "long", day: "numeric" };
            dateElement.textContent = dateObj.toLocaleDateString(
              "en-US",
              options
            );

            chatContainer.appendChild(dateElement);
            lastDate = currentDate;
          }

          if (messageMatch) {
            // It's a regular message
            const [, date, time, sender, text] = messageMatch;

            const messageWrapper = document.createElement("div");
            messageWrapper.className = "flex flex-col";

            const messageBubble = document.createElement("div");
            messageBubble.className =
              "chat-bubble p-2 rounded-lg shadow-sm flex flex-col";

            // Determine if it's an incoming or outgoing message
            if (sender.toLowerCase() === "d") {
              // Assuming 'D' is the user
              messageBubble.classList.add("message-out");
            } else {
              messageBubble.classList.add("message-in");
              // Add sender name for group chats or incoming messages
              const senderName = document.createElement("div");
              senderName.className = "font-bold text-sm text-purple-600";
              senderName.textContent = sender;
              messageBubble.appendChild(senderName);
            }

            const messageText = document.createElement("span");
            messageText.textContent = text;

            const messageTime = document.createElement("span");
            messageTime.className = "text-xs text-gray-500 mt-1 ml-auto";
            messageTime.textContent = time;

            messageBubble.appendChild(messageText);
            messageBubble.appendChild(messageTime);
            messageWrapper.appendChild(messageBubble);
            chatContainer.appendChild(messageWrapper);
          } else if (line.includes("end-to-end encrypted")) {
            // It's the initial encryption message
            const systemMessage = document.createElement("div");
            systemMessage.className =
              "system-message p-1 px-3 rounded-md shadow-sm my-2";
            systemMessage.textContent = line.split(" - ")[1] || line;
            chatContainer.appendChild(systemMessage);
          }
          // Other lines that don't match are ignored (like empty lines)
        });

        // Scroll to the bottom of the chat
        chatContainer.scrollTop = chatContainer.scrollHeight;
      }

      // --- Event Listeners ---
      const renderButton = document.getElementById("render-button");
      const chatInput = document.getElementById("chat-input");

      renderButton.addEventListener("click", renderChat);

      // --- Initial Load ---
      // Populate the textarea with the example chat and render it on load
      chatInput.value = `22/08/2025, 13:51 - Messages and calls are end-to-end encrypted. Only people in this chat can read, listen to, or share them. Learn more.
22/08/2025, 13:51 - +91 70525 52247: Hlo sir
22/08/2025, 15:11 - +91 70525 52247: 
22/08/2025, 15:11 - D: Hello
22/08/2025, 15:11 - D: I'm yet to check about the card
22/08/2025, 15:12 - D: I will not be able to do it right now
22/08/2025, 15:12 - D: Call me anytime tomorrow or Sunday.
22/08/2025, 15:16 - +91 70525 52247: Ok sir
23/08/2025, 12:52 - +91 70525 52247: Hlo
23/08/2025, 12:52 - +91 70525 52247: Sir
23/08/2025, 12:52 - +91 70525 52247: Right now u are free
23/08/2025, 14:59 - +91 70525 52247: ??
23/08/2025, 16:31 - +91 70525 52247: 
23/08/2025, 19:12 - D: may be tomorrow 

i was out today ;)
23/08/2025, 19:12 - +91 70525 52247: Acha sir
23/08/2025, 19:13 - +91 70525 52247: Kl sir kra lijie ga
23/08/2025, 19:18 - D: Okay I'll update you tomorrow.
23/08/2025, 19:19 - +91 70525 52247: Okay sir`;

      window.onload = renderChat;
    </script>
  </body>
</html>
